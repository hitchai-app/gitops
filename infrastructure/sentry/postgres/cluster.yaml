apiVersion: postgresql.cnpg.io/v1
kind: Cluster
metadata:
  name: sentry-postgres
  namespace: sentry-system
spec:
  instances: 1
  imageName: ghcr.io/cloudnative-pg/postgresql:16.8

  storage:
    storageClass: single-replica
    size: 20Gi

  bootstrap:
    initdb:
      database: sentry
      owner: sentry
      postInitSQL:
        - CREATE EXTENSION IF NOT EXISTS citext;

  resources:
    requests:
      memory: 512Mi
      cpu: 250m
    limits:
      memory: 2Gi

  monitoring:
    enablePodMonitor: true
