# Sentry self-hosted Helm values
# Bundled Kafka/Redis/ClickHouse, external Postgres via CNPG
hostname: sentry.ops.last-try.org

# Use existing Secret managed by SealedSecret instead of Helm hook
# This prevents conflict between Helm-created Secret and SealedSecret controller
sentry:
  existingSecret: sentry-sentry-secret

# Enable bundled services
clickhouse:
  enabled: true

kafka:
  enabled: true

postgresql:
  enabled: false

redis:
  enabled: true

zookeeper:
  enabled: false

# External PostgreSQL (CloudNativePG with TLS cert auth)
externalPostgresql:
  host: sentry-postgres-rw.sentry-system.svc.cluster.local
  port: 5432
  database: sentry
  username: sentry
  existingSecret: sentry-postgres-app
  existingSecretKeys:
    password: password
  # CNPG-managed TLS; use password auth
  sslMode: require

# Disable user registration, require SSO
auth:
  register: false

# Resource limits for single-node cluster
resources:
  requests:
    cpu: 500m
    memory: 1Gi
  limits:
    cpu: 2000m
    memory: 4Gi

# Enable metrics for Prometheus
serviceMonitor:
  enabled: true
